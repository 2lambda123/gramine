# HACK: We need to configure libcurl with mbedTLS (even if curl does not detect it). Thus patching
# the configure file here so that it forces the mbedTLS check to always pass.

diff --git a/configure b/configure
index c16635f73a7e9cb3856737c31a4171d2fac29531..50f95778c80dbcd2c2b08963ad19a372dcdb128c 100755
--- a/configure
+++ b/configure
@@ -26829,7 +26829,7 @@ if ac_fn_c_try_link "$LINENO"
 then :
   ac_cv_lib_mbedtls_mbedtls_havege_init=yes
 else $as_nop
-  ac_cv_lib_mbedtls_mbedtls_havege_init=no
+  ac_cv_lib_mbedtls_mbedtls_havege_init=yes
 fi
 rm -f core conftest.err conftest.$ac_objext conftest.beam \
     conftest$ac_exeext conftest.$ac_ext
@@ -26931,8 +26931,6 @@ fi
 printf "%s\n" "$as_me: detected mbedTLS" >&6;}
       check_for_ca_bundle=1
 
-      LIBS="-lmbedtls -lmbedx509 -lmbedcrypto $LIBS"
-
       if test -n "$mbedtlslib"; then
                                         if test "x$cross_compiling" != "xyes"; then
           CURL_LIBRARY_PATH="$CURL_LIBRARY_PATH:$mbedtlslib"
